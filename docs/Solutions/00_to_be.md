# Предлагаемое решение

Я могу ошибаться, конечно, но в данном задании нам специально предлагаются требования к целевой системе, которые, если не подвергнуть лёгкой корректировке, любое решение неизбежно приведёт к однозначно нежелательным последствиям для всех участников, вовлеченных в рассматриваемую бизнес-схему.

Рассмотрим оригинальные требования. Для удобства их пронумеруем и введём аббревиатуру УД, означающую умный дом.

## 1. Требования

### 1.1 Целевая экосистема, которую необходимо создать

  1.1.1 Экосистема доступна пользователю в режиме самообслуживания по модели SaaS.

  1.1.2 Система позволяет управлять отоплением, включать и выключать свет, запирать и отпирать автоматические ворота, удаленно наблюдать за домом и будущее неуточненное поведение.

  1.1.3 Пользователь самостоятельно выбирает необходимые ему модули УД(устройства), сам их подключает, настраивает сценарии работы и просматривает телеметрию.

  1.1.4 Компания не занимается производством устройств, но поддерживает подключение к экосистеме устройств партнеров по стандартным протоколам.

  1.1.5 Веб-разработка передана на аутсорс и не входит в требования данной работы.

### 1.2 Требования к экосистеме

  1.2.1 Модули управления приборами и сами приборы (устройства) должны быть максимально готовы к использованию и продаваться в отдельных комплектах для удобной покупки и подключения.

  1.2.2 Устройства должны быть доступны через интернет (для удаленного наблюдения и доступа), и предполагается, что пользователь будет иметь интернет-канал, к которому их можно подключить.

  1.2.3 Покупатели могут программировать систему для управления различными модулями в соответствии со своими потребностями.

## 2. Цели бизнеса

### 2.1 Промежуточное состояние (через пару месяцев)

  2.1.1 Описана AsIs и ToBe архитектура решения. Создан план по переходу к целевой системе.

  2.1.2 MVP с разделёнными микросервисами для управления отоплением, освещением, наблюдением, воротами.

### 2.2 Финальное состояние (через год)

  2.2.1 Настроенные CI/CD пайплайны для автоматизации сборки и деплоя платформы экосистемы.

  2.2.2 Полностью развернутая экосистема УД с модульной структурой.

  2.2.3 Платформа экосистемы готова к подключению до 100 экопоселков по 200 домов по пять устройств в каждом.
  
  2.2.4 Пользователи могут самостоятельно подключать новые модули, управлять ими через интернет и настраивать автоматические сценарии работы устройств.

## Анализ требований

Вопросы монетизации и коммерческого успеха данного предприятия мы не будем затрагивать, поскольку они находятся вне пространства нашего учебного курса. Кроме того, лично я совсем не разбирался ни в контексте IoT, ни в контексте УД, до того, как начал работать над эти заданием. Но даже мне было достаточно «пробежать глазами» заметку [«Что такое Home Assistant — как настроить умный дом без подключения к облаку»](https://journal.tinkoff.ru/guide/local-smart-home/), чтобы понять, что пп. 1.1.3, 1.1.4, 1.2.1, 2.2.4 требуют определённой конкретизации.

Какие выводы можно сделать, исходя из информации, приведённой в статье?

1. Безопасность системы должна быть на первом месте. Начиная от несанкционированного доступа к управлению любым из устройств, и заканчивая возможным воздействием системы на окружающую среду в случае возникновения внештатной ситуации: отключение электричества, пожар, землетрясение и пр.

2. Подключение умной лампочки к умной колонке через облака — очень яркий пример ~~преступного легкомыслия~~ плохой архитектуры.

3. В то же время далеко не каждый обитатель потенциально УД способен развернуть и настроить систему, сходную с той, что создал Михаил Шардин.

Поэтому для серьёзного бизнеса есть достаточно узкая ниша — предложить конечному пользователю решение, способное избавить его практически от всех тех сложностей, с которыми столкнулся автор статьи.

Возвращаясь к нашим требованиям, нам следует внести ясность в терминологию: мы будем называть *модулем* «сердце» УД — тот промышленный (может быть даже, вандало-защищённый) компьютер, к которому с одной стороны должны подключаться разнообразными способами по всевозможным протоколам конечные *устройства* (датчики, выключатели, камеры, контроллеры, электроприводы и пр.). С другой стороны посредством интернета к *модулю* должно подключаться мобильное приложение на смартфонах владельца данного модуля (и членов его семьи). И уже с третьей стороны будет подключение к проектируемой в рамках данного задания инфраструктуре.

Для того, чтобы это «третьестороннее» подключение в глазах пользователя имело весомую ценность, этому пользователю необходимо предложить некие привлекательные условия. А чтобы такие условия могли быть созданы, в принципе, компания если и не будет сама заниматься производством модулей, тем не менее, должна этот процесс жёстко контролировать.

Тут я позволю себе привести аналогию с Ростелекомом. При подключении по оптоволокну новому абоненту выдают (как правило, в аренду) оптический терминал (ONT), которым абонент может управлять — но только в контексте своей домашней сети. А административные функции на ONT выполняет персонал оператора связи. Ростелеком сам, конечно, не производит ONT. Последнее и достаточно продолжительное время эти маршрутизаторы поставляет Элтекс.

Важный момент во всём этом, это где проходит граница ответственности. Как и в случае с Ростелекомом — по терминалу, для рассматриваемого предприятия такая граница должна пройти прямо по модулю. Смысл в том, что имея весьма небольшой штат технических специалистов, компания не сможет осуществлять качественную поддержку широкого набора устройств, только максимально узкую линейку протестированных (как минимум) в лабораторных условиях модулей.
